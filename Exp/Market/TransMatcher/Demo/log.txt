
Create IBN-Net model resnet18_ibn_b.

main.py --testset cuhk03_np_detected,market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset cuhk03_np_detected,market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset cuhk03_np_detected,market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset cuhk03_np_detected,market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset cuhk03_np_detected,market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset cuhk03_np_detected,market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset cuhk03_np_detected,market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset cuhk03_np_detected,market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	Feature time: 11.438 seconds. Data time: 18.627 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.073 seconds.

Total GS time: 35.078 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.907. Acc: 36.62%. Training time: 90 seconds.                  

Evaluate the learned model:
CUHK dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |     0 |        0
  query    |     0 |        0
  gallery  |     0 |        0
Compute similarity ...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset cuhk03_np_detected,market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	Feature time: 7.422 seconds. Data time: 15.516 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.830 seconds.

Total GS time: 27.444 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.967. Acc: 39.21%. Training time: 84 seconds.                  

Evaluate the learned model:
CUHK dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |     0 |        0
  query    |     0 |        0
  gallery  |     0 |        0
Compute similarity ...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset cuhk03_np_detected,market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 10 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	Feature time: 7.387 seconds. Data time: 21.249 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.906 seconds.

Total GS time: 33.295 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.976. Acc: 37.33%. Training time: 104 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 1.637 seconds. Data time: 20.013 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.946 seconds.

Total GS time: 26.528 seconds.

* Finished epoch 2 at lr=[0.0005, 0.005, 0.005]. Loss: 3.931. Acc: 35.59%. Training time: 195 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 2.260 seconds. Data time: 19.604 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.018 seconds.

Total GS time: 26.828 seconds.

* Finished epoch 3 at lr=[0.0005, 0.005, 0.005]. Loss: 3.959. Acc: 33.47%. Training time: 281 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 1.635 seconds. Data time: 19.565 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.945 seconds.

Total GS time: 26.204 seconds.

* Finished epoch 4 at lr=[0.0005, 0.005, 0.005]. Loss: 3.666. Acc: 41.66%. Training time: 378 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 1.641 seconds. Data time: 18.964 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.999 seconds.

Total GS time: 25.687 seconds.

* Finished epoch 5 at lr=[0.0005, 0.005, 0.005]. Loss: 3.595. Acc: 43.01%. Training time: 471 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 1.711 seconds. Data time: 14.760 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.937 seconds.

Total GS time: 21.416 seconds.

* Finished epoch 6 at lr=[0.0005, 0.005, 0.005]. Loss: 3.547. Acc: 43.03%. Training time: 550 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.765 seconds. Data time: 14.998 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.910 seconds.

Total GS time: 20.362 seconds.

* Finished epoch 7 at lr=[0.0005, 0.005, 0.005]. Loss: 3.614. Acc: 40.75%. Training time: 621 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.824 seconds. Data time: 14.820 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.942 seconds.

Total GS time: 20.265 seconds.

* Finished epoch 8 at lr=[0.0005, 0.005, 0.005]. Loss: 3.609. Acc: 40.45%. Training time: 690 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.763 seconds. Data time: 14.952 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.930 seconds.

Total GS time: 20.320 seconds.

* Finished epoch 9 at lr=[0.0005, 0.005, 0.005]. Loss: 3.361. Acc: 47.84%. Training time: 758 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 2.504 seconds. Data time: 18.587 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.922 seconds.

Total GS time: 26.099 seconds.

* Finished epoch 10 at lr=[0.0005, 0.005, 0.005]. Loss: 3.393. Acc: 46.32%. Training time: 832 seconds.                  

Evaluate the learned model:
CUHK dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |     0 |        0
  query    |     0 |        0
  gallery  |     0 |        0
Compute similarity ...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	Feature time: 6.081 seconds. Data time: 13.098 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.085 seconds.

Total GS time: 24.847 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.748. Acc: 44.92%. Training time: 64 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
Compute similarity ...	Time: 284.214 seconds.
Mean AP: 1.8%
CMC Scores
  top-1           2.2%
  top-5           5.7%
  top-10          9.4%
  top-20         14.6%
  market: rank1=2.2, mAP=1.8.

Finished training at epoch 1, loss = 3.748, acc = 44.92%.

Total training time: 64.242 sec. Average training time per epoch: 64.242 sec.
Total testing time: 296.916 sec.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 10 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	Feature time: 8.009 seconds. Data time: 15.922 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.123 seconds.

Total GS time: 29.659 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.465. Acc: 53.33%. Training time: 70 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.823 seconds. Data time: 15.788 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.810 seconds.

Total GS time: 22.022 seconds.

* Finished epoch 2 at lr=[0.0005, 0.005, 0.005]. Loss: 3.814. Acc: 38.81%. Training time: 129 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.821 seconds. Data time: 12.958 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.859 seconds.

Total GS time: 19.226 seconds.

* Finished epoch 3 at lr=[0.0005, 0.005, 0.005]. Loss: 2.200. Acc: 72.59%. Training time: 187 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.988 seconds. Data time: 12.896 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.997 seconds.

Total GS time: 19.467 seconds.

* Finished epoch 4 at lr=[0.0005, 0.005, 0.005]. Loss: 2.454. Acc: 69.92%. Training time: 243 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.993 seconds. Data time: 13.159 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.689 seconds.

Total GS time: 19.465 seconds.

* Finished epoch 5 at lr=[0.0005, 0.005, 0.005]. Loss: 2.434. Acc: 68.48%. Training time: 300 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.811 seconds. Data time: 13.332 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.636 seconds.

Total GS time: 19.386 seconds.

* Finished epoch 6 at lr=[0.0005, 0.005, 0.005]. Loss: 2.066. Acc: 70.82%. Training time: 357 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.993 seconds. Data time: 16.314 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.935 seconds.

Total GS time: 22.857 seconds.

* Finished epoch 7 at lr=[0.0005, 0.005, 0.005]. Loss: 0.706. Acc: 92.36%. Training time: 420 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.951 seconds. Data time: 16.148 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.011 seconds.

Total GS time: 22.730 seconds.

* Finished epoch 8 at lr=[0.0005, 0.005, 0.005]. Loss: 0.464. Acc: 95.34%. Training time: 481 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.917 seconds. Data time: 16.129 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.978 seconds.

Total GS time: 22.637 seconds.

* Finished epoch 9 at lr=[0.0005, 0.005, 0.005]. Loss: 1.682. Acc: 81.26%. Training time: 544 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.866 seconds. Data time: 16.404 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.974 seconds.

Total GS time: 22.881 seconds.

* Finished epoch 10 at lr=[0.0005, 0.005, 0.005]. Loss: 0.920. Acc: 88.17%. Training time: 605 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
Compute similarity ...	Time: 279.480 seconds.
Mean AP: 0.9%
CMC Scores
  top-1           1.4%
  top-5           4.6%
  top-10          7.4%
  top-20         11.4%
  market: rank1=1.4, mAP=0.9.

Finished training at epoch 10, loss = 0.920, acc = 88.17%.

Total training time: 605.184 sec. Average training time per epoch: 60.518 sec.
Total testing time: 291.309 sec.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 10 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 20 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	Feature time: 6.719 seconds. Data time: 13.028 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.918 seconds.

Total GS time: 25.231 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.829. Acc: 43.48%. Training time: 64 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.828 seconds. Data time: 16.077 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.158 seconds.

Total GS time: 22.655 seconds.

* Finished epoch 2 at lr=[0.0005, 0.005, 0.005]. Loss: 4.036. Acc: 32.52%. Training time: 125 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.852 seconds. Data time: 16.049 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.091 seconds.

Total GS time: 22.579 seconds.

* Finished epoch 3 at lr=[0.0005, 0.005, 0.005]. Loss: 3.682. Acc: 41.74%. Training time: 186 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 1.003 seconds. Data time: 15.902 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.049 seconds.

Total GS time: 22.554 seconds.

* Finished epoch 4 at lr=[0.0005, 0.005, 0.005]. Loss: 3.745. Acc: 38.17%. Training time: 247 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.922 seconds. Data time: 16.307 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.973 seconds.

Total GS time: 22.833 seconds.

* Finished epoch 5 at lr=[0.0005, 0.005, 0.005]. Loss: 3.498. Acc: 44.54%. Training time: 309 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.857 seconds. Data time: 16.272 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.889 seconds.

Total GS time: 22.633 seconds.

* Finished epoch 6 at lr=[0.0005, 0.005, 0.005]. Loss: 3.677. Acc: 39.75%. Training time: 369 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.916 seconds. Data time: 13.466 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.612 seconds.

Total GS time: 19.604 seconds.

* Finished epoch 7 at lr=[0.0005, 0.005, 0.005]. Loss: 3.476. Acc: 44.16%. Training time: 425 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.916 seconds. Data time: 13.386 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.572 seconds.

Total GS time: 19.469 seconds.

* Finished epoch 8 at lr=[0.0005, 0.005, 0.005]. Loss: 2.924. Acc: 54.98%. Training time: 482 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.812 seconds. Data time: 13.316 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.604 seconds.

Total GS time: 19.315 seconds.

* Finished epoch 9 at lr=[0.0005, 0.005, 0.005]. Loss: 3.205. Acc: 49.58%. Training time: 538 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.837 seconds. Data time: 13.540 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.631 seconds.

Total GS time: 19.578 seconds.

* Finished epoch 10 at lr=[0.0005, 0.005, 0.005]. Loss: 3.227. Acc: 48.78%. Training time: 594 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.915 seconds. Data time: 13.024 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.787 seconds.

Total GS time: 19.297 seconds.

* Finished epoch 11 at lr=[5e-05, 0.0005, 0.0005]. Loss: 3.126. Acc: 50.50%. Training time: 651 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.933 seconds. Data time: 15.904 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.153 seconds.

Total GS time: 22.597 seconds.

* Finished epoch 12 at lr=[5e-05, 0.0005, 0.0005]. Loss: 3.087. Acc: 51.30%. Training time: 712 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.929 seconds. Data time: 15.928 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.086 seconds.

Total GS time: 22.543 seconds.

* Finished epoch 13 at lr=[5e-05, 0.0005, 0.0005]. Loss: 3.239. Acc: 48.12%. Training time: 773 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.814 seconds. Data time: 15.861 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.166 seconds.

Total GS time: 22.445 seconds.

* Finished epoch 14 at lr=[5e-05, 0.0005, 0.0005]. Loss: 2.870. Acc: 55.46%. Training time: 834 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.780 seconds. Data time: 16.258 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.923 seconds.

Total GS time: 22.582 seconds.

* Finished epoch 15 at lr=[5e-05, 0.0005, 0.0005]. Loss: 2.879. Acc: 56.23%. Training time: 894 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.855 seconds. Data time: 16.156 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.010 seconds.

Total GS time: 22.672 seconds.

* Finished epoch 16 at lr=[5e-05, 0.0005, 0.0005]. Loss: 3.043. Acc: 51.51%. Training time: 955 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.926 seconds. Data time: 13.281 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.656 seconds.

Total GS time: 19.453 seconds.

* Finished epoch 17 at lr=[5e-05, 0.0005, 0.0005]. Loss: 3.184. Acc: 48.05%. Training time: 1011 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.940 seconds. Data time: 13.430 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.703 seconds.

Total GS time: 19.683 seconds.

* Finished epoch 18 at lr=[5e-05, 0.0005, 0.0005]. Loss: 2.970. Acc: 53.53%. Training time: 1067 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.844 seconds. Data time: 13.345 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.700 seconds.

Total GS time: 19.496 seconds.

* Finished epoch 19 at lr=[5e-05, 0.0005, 0.0005]. Loss: 2.975. Acc: 53.26%. Training time: 1124 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.918 seconds. Data time: 13.382 seconds.
	 GraphSampler: 	Compute distance...	Time: 4.586 seconds.

Total GS time: 19.476 seconds.

* Finished epoch 20 at lr=[5e-05, 0.0005, 0.0005]. Loss: 3.104. Acc: 51.05%. Training time: 1180 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
Compute similarity ...	Time: 281.214 seconds.
Mean AP: 31.3%
CMC Scores
  top-1          54.9%
  top-5          76.0%
  top-10         83.6%
  top-20         88.9%
  market: rank1=54.9, mAP=31.3.

Finished training at epoch 20, loss = 3.104, acc = 51.05%.

Total training time: 1180.366 sec. Average training time per epoch: 59.018 sec.
Total testing time: 293.615 sec.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 20 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 40 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	Feature time: 6.755 seconds. Data time: 14.113 seconds.
	 GraphSampler: 	Compute distance...	Time: 2.674 seconds.

Total GS time: 24.198 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.848. Acc: 40.30%. Training time: 65 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.526 seconds. Data time: 13.227 seconds.
	 GraphSampler: 	Compute distance...	Time: 2.827 seconds.

Total GS time: 17.200 seconds.

* Finished epoch 2 at lr=[0.0005, 0.005, 0.005]. Loss: 2.426. Acc: 67.86%. Training time: 122 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.416 seconds. Data time: 14.025 seconds.
	 GraphSampler: 	Compute distance...	Time: 2.736 seconds.

Total GS time: 17.797 seconds.

* Finished epoch 3 at lr=[0.0005, 0.005, 0.005]. Loss: 2.598. Acc: 62.45%. Training time: 179 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.561 seconds. Data time: 13.725 seconds.
	 GraphSampler: 	Compute distance...	Time: 2.656 seconds.

Total GS time: 17.546 seconds.

* Finished epoch 4 at lr=[0.0005, 0.005, 0.005]. Loss: 1.745. Acc: 77.33%. Training time: 235 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.376 seconds. Data time: 13.715 seconds.
	 GraphSampler: 	Compute distance...	Time: 2.649 seconds.

Total GS time: 17.339 seconds.

* Finished epoch 5 at lr=[0.0005, 0.005, 0.005]. Loss: 1.154. Acc: 85.77%. Training time: 291 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.720 seconds. Data time: 13.652 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.371 seconds.

Total GS time: 18.347 seconds.

* Finished epoch 6 at lr=[0.0005, 0.005, 0.005]. Loss: 1.976. Acc: 71.17%. Training time: 348 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.633 seconds. Data time: 13.079 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.254 seconds.

Total GS time: 17.537 seconds.

* Finished epoch 7 at lr=[0.0005, 0.005, 0.005]. Loss: 1.377. Acc: 78.93%. Training time: 403 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.435 seconds. Data time: 13.559 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.355 seconds.

Total GS time: 17.953 seconds.

* Finished epoch 8 at lr=[0.0005, 0.005, 0.005]. Loss: 2.275. Acc: 63.75%. Training time: 459 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.739 seconds. Data time: 13.412 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.259 seconds.

Total GS time: 18.016 seconds.

* Finished epoch 9 at lr=[0.0005, 0.005, 0.005]. Loss: 2.202. Acc: 66.51%. Training time: 515 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.638 seconds. Data time: 13.127 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.264 seconds.

Total GS time: 17.619 seconds.

* Finished epoch 10 at lr=[0.0005, 0.005, 0.005]. Loss: 2.797. Acc: 55.31%. Training time: 571 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.740 seconds. Data time: 13.701 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.269 seconds.

Total GS time: 18.332 seconds.

* Finished epoch 11 at lr=[5e-05, 0.0005, 0.0005]. Loss: 3.305. Acc: 44.44%. Training time: 627 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.699 seconds. Data time: 13.011 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.284 seconds.

Total GS time: 17.565 seconds.

* Finished epoch 12 at lr=[5e-05, 0.0005, 0.0005]. Loss: 2.377. Acc: 60.29%. Training time: 683 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.757 seconds. Data time: 13.179 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.253 seconds.

Total GS time: 17.772 seconds.

* Finished epoch 13 at lr=[5e-05, 0.0005, 0.0005]. Loss: 2.455. Acc: 59.99%. Training time: 738 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.819 seconds. Data time: 13.065 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.257 seconds.

Total GS time: 17.730 seconds.

* Finished epoch 14 at lr=[5e-05, 0.0005, 0.0005]. Loss: 2.162. Acc: 65.83%. Training time: 793 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.638 seconds. Data time: 13.726 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.285 seconds.

Total GS time: 18.258 seconds.

* Finished epoch 15 at lr=[5e-05, 0.0005, 0.0005]. Loss: 2.219. Acc: 65.05%. Training time: 851 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.660 seconds. Data time: 13.617 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.384 seconds.

Total GS time: 18.269 seconds.

* Finished epoch 16 at lr=[5e-05, 0.0005, 0.0005]. Loss: 2.158. Acc: 65.95%. Training time: 907 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.646 seconds. Data time: 13.318 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.263 seconds.

Total GS time: 17.817 seconds.

* Finished epoch 17 at lr=[5e-05, 0.0005, 0.0005]. Loss: 2.157. Acc: 66.23%. Training time: 961 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.745 seconds. Data time: 13.548 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.286 seconds.

Total GS time: 18.247 seconds.

* Finished epoch 18 at lr=[5e-05, 0.0005, 0.0005]. Loss: 1.692. Acc: 74.72%. Training time: 1017 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.784 seconds. Data time: 13.359 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.257 seconds.

Total GS time: 18.000 seconds.

* Finished epoch 19 at lr=[5e-05, 0.0005, 0.0005]. Loss: 1.974. Acc: 70.12%. Training time: 1074 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.875 seconds. Data time: 13.615 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.333 seconds.

Total GS time: 18.426 seconds.

* Finished epoch 20 at lr=[5e-05, 0.0005, 0.0005]. Loss: 1.877. Acc: 71.74%. Training time: 1131 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.495 seconds. Data time: 13.839 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.252 seconds.

Total GS time: 18.221 seconds.

* Finished epoch 21 at lr=[5e-06, 5e-05, 5e-05]. Loss: 1.282. Acc: 80.68%. Training time: 1189 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.848 seconds. Data time: 13.328 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.240 seconds.

Total GS time: 18.016 seconds.

* Finished epoch 22 at lr=[5e-06, 5e-05, 5e-05]. Loss: 1.921. Acc: 70.77%. Training time: 1244 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.647 seconds. Data time: 13.818 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.238 seconds.

Total GS time: 18.312 seconds.

* Finished epoch 23 at lr=[5e-06, 5e-05, 5e-05]. Loss: 1.227. Acc: 81.36%. Training time: 1299 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.839 seconds. Data time: 13.103 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.252 seconds.

Total GS time: 17.782 seconds.

* Finished epoch 24 at lr=[5e-06, 5e-05, 5e-05]. Loss: 2.055. Acc: 68.82%. Training time: 1354 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.737 seconds. Data time: 13.129 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.251 seconds.

Total GS time: 17.684 seconds.

* Finished epoch 25 at lr=[5e-06, 5e-05, 5e-05]. Loss: 1.602. Acc: 75.93%. Training time: 1409 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.762 seconds. Data time: 13.044 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.241 seconds.

Total GS time: 17.641 seconds.

* Finished epoch 26 at lr=[5e-06, 5e-05, 5e-05]. Loss: 1.746. Acc: 73.25%. Training time: 1464 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.459 seconds. Data time: 13.863 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.406 seconds.

Total GS time: 18.368 seconds.

* Finished epoch 27 at lr=[5e-06, 5e-05, 5e-05]. Loss: 1.851. Acc: 72.95%. Training time: 1520 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.575 seconds. Data time: 13.545 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.364 seconds.

Total GS time: 18.153 seconds.

* Finished epoch 28 at lr=[5e-06, 5e-05, 5e-05]. Loss: 1.343. Acc: 80.23%. Training time: 1577 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.713 seconds. Data time: 13.703 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.285 seconds.

Total GS time: 18.296 seconds.

* Finished epoch 29 at lr=[5e-06, 5e-05, 5e-05]. Loss: 1.731. Acc: 74.88%. Training time: 1633 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.588 seconds. Data time: 13.734 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.249 seconds.

Total GS time: 18.177 seconds.

* Finished epoch 30 at lr=[5e-06, 5e-05, 5e-05]. Loss: 1.389. Acc: 78.96%. Training time: 1689 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.722 seconds. Data time: 13.350 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.258 seconds.

Total GS time: 17.894 seconds.

* Finished epoch 31 at lr=[5e-07, 5e-06, 5e-06]. Loss: 1.830. Acc: 73.24%. Training time: 1745 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.488 seconds. Data time: 13.499 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.365 seconds.

Total GS time: 17.953 seconds.

* Finished epoch 32 at lr=[5e-07, 5e-06, 5e-06]. Loss: 1.520. Acc: 76.93%. Training time: 1800 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.437 seconds. Data time: 13.923 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.544 seconds.

Total GS time: 18.520 seconds.

* Finished epoch 33 at lr=[5e-07, 5e-06, 5e-06]. Loss: 1.815. Acc: 72.69%. Training time: 1857 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.694 seconds. Data time: 12.997 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.248 seconds.

Total GS time: 17.510 seconds.

* Finished epoch 34 at lr=[5e-07, 5e-06, 5e-06]. Loss: 1.601. Acc: 75.30%. Training time: 1912 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.460 seconds. Data time: 13.824 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.365 seconds.

Total GS time: 18.304 seconds.

* Finished epoch 35 at lr=[5e-07, 5e-06, 5e-06]. Loss: 1.950. Acc: 71.80%. Training time: 1969 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.726 seconds. Data time: 13.246 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.244 seconds.

Total GS time: 17.824 seconds.

* Finished epoch 36 at lr=[5e-07, 5e-06, 5e-06]. Loss: 1.142. Acc: 82.22%. Training time: 2024 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.612 seconds. Data time: 13.252 seconds.
	 GraphSampler: 	Compute distance...	Time: 2.583 seconds.

Total GS time: 17.054 seconds.

* Finished epoch 37 at lr=[5e-07, 5e-06, 5e-06]. Loss: 1.791. Acc: 72.54%. Training time: 2080 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.565 seconds. Data time: 13.123 seconds.
	 GraphSampler: 	Compute distance...	Time: 2.688 seconds.

Total GS time: 16.973 seconds.

* Finished epoch 38 at lr=[5e-07, 5e-06, 5e-06]. Loss: 0.802. Acc: 88.13%. Training time: 2134 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.399 seconds. Data time: 13.499 seconds.
	 GraphSampler: 	Compute distance...	Time: 2.719 seconds.

Total GS time: 17.265 seconds.

* Finished epoch 39 at lr=[5e-07, 5e-06, 5e-06]. Loss: 1.512. Acc: 78.36%. Training time: 2188 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.692 seconds. Data time: 13.688 seconds.
	 GraphSampler: 	Compute distance...	Time: 2.637 seconds.

Total GS time: 17.641 seconds.

* Finished epoch 40 at lr=[5e-07, 5e-06, 5e-06]. Loss: 1.704. Acc: 73.57%. Training time: 2243 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
Compute similarity ...	Time: 298.021 seconds.
Mean AP: 3.2%
CMC Scores
  top-1           5.5%
  top-5          13.4%
  top-10         19.3%
  top-20         25.7%
  market: rank1=5.5, mAP=3.2.

Finished training at epoch 40, loss = 1.704, acc = 73.57%.

Total training time: 2243.349 sec. Average training time per epoch: 56.084 sec.
Total testing time: 310.282 sec.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 40 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |   751 |    15913
	 GraphSampler: 	Extract Features...	Feature time: 5.419 seconds. Data time: 13.140 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.212 seconds.

Total GS time: 22.399 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.833. Acc: 43.26%. Training time: 62 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |   751 |    15913
Compute similarity ...	Time: 32.364 seconds.
Mean AP: 2.0%
CMC Scores
  top-1           0.0%
  top-5           0.0%
  top-10          0.0%
  top-20          0.0%
  market: rank1=0.0, mAP=2.0.

Finished training at epoch 1, loss = 3.833, acc = 43.26%.

Total training time: 62.333 sec. Average training time per epoch: 62.333 sec.
Total testing time: 32.698 sec.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |     1 |        3
	 GraphSampler: 	Extract Features...	Feature time: 5.799 seconds. Data time: 13.415 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.270 seconds.

Total GS time: 23.089 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.599. Acc: 46.85%. Training time: 63 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |     1 |        3
Compute similarity ...	Time: 4.578 seconds.
Mean AP: 100.0%
CMC Scores
  top-1         100.0%
  top-5         100.0%
  top-10        100.0%
  top-20        100.0%
  market: rank1=100.0, mAP=100.0.

Finished training at epoch 1, loss = 3.599, acc = 46.85%.

Total training time: 63.196 sec. Average training time per epoch: 63.196 sec.
Total testing time: 4.695 sec.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |     1 |        2
	 GraphSampler: 	Extract Features...	Feature time: 5.315 seconds. Data time: 13.421 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.294 seconds.

Total GS time: 22.634 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.797. Acc: 42.28%. Training time: 63 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |     1 |        2
Compute similarity ...	Time: 4.410 seconds.
Mean AP: 100.0%
CMC Scores
  top-1         100.0%
  top-5         100.0%
  top-10        100.0%
  top-20        100.0%
  market: rank1=100.0, mAP=100.0.

Finished training at epoch 1, loss = 3.797, acc = 42.28%.

Total training time: 63.243 sec. Average training time per epoch: 63.243 sec.
Total testing time: 4.524 sec.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	Feature time: 5.693 seconds. Data time: 13.372 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.293 seconds.

Total GS time: 22.948 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.564. Acc: 47.32%. Training time: 63 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
Compute similarity ...	Time: 4.870 seconds.
Mean AP: 61.1%
CMC Scores
  top-1         100.0%
  top-5         100.0%
  top-10        100.0%
  top-20        100.0%
  market: rank1=100.0, mAP=61.1.

Finished training at epoch 1, loss = 3.564, acc = 47.32%.

Total training time: 62.668 sec. Average training time per epoch: 62.668 sec.
Total testing time: 4.989 sec.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	Feature time: 10.300 seconds. Data time: 15.014 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.124 seconds.

Total GS time: 31.411 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 4.050. Acc: 35.69%. Training time: 81 seconds.                  


Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 3 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	Feature time: 5.766 seconds. Data time: 16.366 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.222 seconds.

Total GS time: 28.021 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.464. Acc: 50.62%. Training time: 83 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.899 seconds. Data time: 16.153 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.192 seconds.

Total GS time: 22.952 seconds.

* Finished epoch 2 at lr=[0.0005, 0.005, 0.005]. Loss: 2.728. Acc: 59.69%. Training time: 157 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.608 seconds. Data time: 26.841 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.386 seconds.

Total GS time: 33.555 seconds.

* Finished epoch 3 at lr=[0.0005, 0.005, 0.005]. Loss: 3.082. Acc: 54.39%. Training time: 251 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
Compute similarity ...	pepe
Time: 8.405 seconds.
Mean AP: 100.0%
CMC Scores
  top-1         100.0%
  top-5         100.0%
  top-10        100.0%
  top-20        100.0%
  market: rank1=100.0, mAP=100.0.

Finished training at epoch 3, loss = 3.082, acc = 54.39%.

Total training time: 250.959 sec. Average training time per epoch: 83.653 sec.
Total testing time: 8.637 sec.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 3 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 3 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	Feature time: 6.288 seconds. Data time: 14.950 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.203 seconds.

Total GS time: 27.477 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.566. Acc: 44.76%. Training time: 103 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 0.886 seconds. Data time: 14.948 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.288 seconds.

Total GS time: 21.857 seconds.

* Finished epoch 2 at lr=[0.0005, 0.005, 0.005]. Loss: 3.490. Acc: 46.04%. Training time: 198 seconds.                  

	 GraphSampler: 	Extract Features...	Feature time: 1.656 seconds. Data time: 14.878 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.157 seconds.

Total GS time: 22.728 seconds.

* Finished epoch 3 at lr=[0.0005, 0.005, 0.005]. Loss: 3.458. Acc: 43.69%. Training time: 273 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
Compute similarity ...		
tensor([[0.5290, 0.4921, 0.5117, 0.5010, 0.5333, 0.4806, 0.5149, 0.5438, 0.5482,
         0.5093, 0.5168, 0.5369, 0.5584, 0.5455, 0.4920, 0.5176, 0.5734, 0.5185,
         0.5544, 0.5601, 0.5658, 0.5417, 0.5330, 0.4903, 0.4411, 0.5382, 0.5311,
         0.5451, 0.5377, 0.5592, 0.5389, 0.4537, 0.5254, 0.5249, 0.5221, 0.5511,
         0.5507, 0.5810, 0.4872, 0.5187, 0.5164, 0.5326, 0.5106, 0.5560, 0.5316,
         0.5419, 0.5450, 0.3659, 0.4788, 0.3338]])
	
Time: 6.026 seconds.
Mean AP: 70.0%
CMC Scores
  top-1         100.0%
  top-5         100.0%
  top-10        100.0%
  top-20        100.0%
  market: rank1=100.0, mAP=70.0.

Finished training at epoch 3, loss = 3.458, acc = 43.69%.

Total training time: 272.718 sec. Average training time per epoch: 90.906 sec.
Total testing time: 6.197 sec.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 3 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	Feature time: 8.993 seconds. Data time: 13.188 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.354 seconds.

Total GS time: 26.138 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 4.183. Acc: 31.32%. Training time: 70 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
Compute similarity ...		
50
	
	
tensor([[0.5201, 0.5379, 0.5757, 0.5315, 0.5196, 0.5555, 0.5583, 0.5939, 0.5234,
         0.5426, 0.5741, 0.4328, 0.3636, 0.3164, 0.3419, 0.3775, 0.5163, 0.5157,
         0.5171, 0.5325, 0.5767, 0.5729, 0.5960, 0.5739, 0.5909, 0.5847, 0.6227,
         0.5619, 0.6041, 0.5547, 0.4942, 0.5785, 0.5328, 0.5501, 0.5442, 0.4352,
         0.5525, 0.4668, 0.2942, 0.3591, 0.3782, 0.3871, 0.4138, 0.4221, 0.6047,
         0.5286, 0.5391, 0.5243, 0.3263, 0.2390]])
	
Time: 4.655 seconds.
Mean AP: 75.0%
CMC Scores
  top-1         100.0%
  top-5         100.0%
  top-10        100.0%
  top-20        100.0%
  market: rank1=100.0, mAP=75.0.

Finished training at epoch 1, loss = 4.183, acc = 31.32%.

Total training time: 69.573 sec. Average training time per epoch: 69.573 sec.
Total testing time: 4.792 sec.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	Feature time: 5.764 seconds. Data time: 12.959 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.297 seconds.

Total GS time: 22.614 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.902. Acc: 40.23%. Training time: 65 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
Compute similarity ...		

Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	Feature time: 5.556 seconds. Data time: 14.882 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.283 seconds.

Total GS time: 24.365 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.825. Acc: 42.29%. Training time: 68 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
Compute similarity ...		

Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	Feature time: 5.399 seconds. Data time: 14.849 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.419 seconds.

Total GS time: 24.292 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.759. Acc: 41.15%. Training time: 82 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
Compute similarity ...		

Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	
Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	Feature time: 9.189 seconds. Data time: 15.204 seconds.
	 GraphSampler: 	Compute distance...	Time: 3.324 seconds.

Total GS time: 28.403 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.776. Acc: 43.34%. Training time: 70 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
Compute similarity ...		
	
Time: 5.442 seconds.
Mean AP: 23.6%
CMC Scores
  top-1           0.0%
  top-5         100.0%
  top-10        100.0%
  top-20        100.0%
  market: rank1=0.0, mAP=23.6.

Finished training at epoch 1, loss = 3.776, acc = 43.34%.

Total training time: 70.443 sec. Average training time per epoch: 70.443 sec.
Total testing time: 5.624 sec.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	Feature time: 5.929 seconds. Data time: 14.768 seconds.
	 GraphSampler: 	Compute distance...	Time: 5.097 seconds.

Total GS time: 26.441 seconds.

* Finished epoch 1 at lr=[0.0005, 0.005, 0.005]. Loss: 3.086. Acc: 57.36%. Training time: 68 seconds.                  

Evaluate the learned model:
Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
Compute similarity ...		
Print image
	
Time: 5.423 seconds.
Mean AP: 31.2%
CMC Scores
  top-1           0.0%
  top-5         100.0%
  top-10        100.0%
  top-20        100.0%
  market: rank1=0.0, mAP=31.2.

Finished training at epoch 1, loss = 3.086, acc = 57.36%.

Total training time: 68.265 sec. Average training time per epoch: 68.265 sec.
Total testing time: 5.617 sec.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 


Create IBN-Net model resnet18_ibn_b.

main.py --testset market --data-dir ./Data/ --exp-dir ./Exp/ --method TransMatcher --sub_method Demo --dataset market -a resnet18 -b 8 -j 1 --neck 64 --num_trans_layers 1 --dim_feedforward 128 --epochs 1 --test_gal_batch 32 --test_prob_batch 32 --gs_verbose 

Market dataset loaded
  subset   | # ids | # images
  ---------------------------
  train    |   751 |    12936
  query    |     1 |        1
  gallery  |    12 |       50
	 GraphSampler: 	Extract Features...	